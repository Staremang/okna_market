$(document).ready(function(){$("input[type=tel]").inputmask({mask:"+7 (999) 999-99-99"}),$("input[type=email]").inputmask({alias:"email"}),$("form").on("submit",function(e){e.preventDefault();var t=$(this),a=$(this).serialize(),o=$(this).attr("id"),s=$(this).find('button[type="submit"]'),r=s.text(),i=JSON.parse(localStorage.getItem("sentForms"));i&&""!=i||(i={interview:!1,guestVisit:!1,gift:!1,callMe:!1}),$.ajax({type:"POST",url:url,data:a,beforeSend:function(){s.attr("disabled",""),s.text("Отправка...")},error:function(e){alert("Ошибка "+e.status+". Повторите позднее."),s.removeAttr("disabled"),s.text(r)},success:function(e){s.removeAttr("disabled"),s.text(r);if((e=JSON.parse(e)).sended){switch(o){case"guest-visit-form":i.gift?$.fancybox.open($("#thanks")):($("#gift-parent-name").val($("#guest-visit-form__name").val()),$.fancybox.open($("#thanks-and-gift-form"))),"gostevoi",i.guestVisit=!0;break;case"call-me-form":switch($.fancybox.close(),$.fancybox.open($("#thanks")),t.data("form")){case"promo-1":"promo2";break;case"promo-2":"gost2";break;default:"zvonok"}break;case"promo-form-1":case"promo-form-2":$.fancybox.close(),$.fancybox.open($("#thanks")),"promo1";break;case"guest-visit-promo-form-1":case"guest-visit-promo-form-2":$.fancybox.close(),$.fancybox.open($("#thanks")),"gost1"}t[0].reset(),localStorage.setItem("sentForms",JSON.stringify(i))}else alert(e.message)}})})});